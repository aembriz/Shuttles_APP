<div class="container-fluid">
	<script src="js/holder/holder.js"></script>
	<link href="css/mapa.css" rel="stylesheet">
	<script src="js/mapa-busqueda.js"></script>
	<br/>
	<br/>
	<h1 class="page-header" align="center">Buscar Ruta</h1>
	<link href="css/panels.css" rel="stylesheet">
	<link href="css/modal.css" rel="stylesheet">
	
	<div class="form-1200">

		<div class="animate-switch" ng-show="mostrarSugerencias==true">
			<div class="panel panel-info">
				<div class="panel-heading" align="center">
					<!-- sugerir rutas -->
					<b>Lista de rutas sugeridas</b>
				</div>

				<div class="panel-body" align="center">
					<div class="alert alert-danger alert-dismissable" ng-show="(errMsg != null)&&(errMsg != '')">
					  <button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button>
					  <strong>Error!</strong> {{errMsg}}
					</div>
					<div class="alert alert-success alert-dismissable" ng-show="(sucMsg != null)&&(sucMsg != '')">
					  <button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button>
					  {{sucMsg}}
					</div>  
					<img ng-show="(cargandorutas==null)&&(errMsg == null)" alt="Loading  Content" src="imgs/loading.gif" height="25px" />		
					<div bn-slide-show="message!=''" slide-show-duration="500" style="float: center" ng-class="messageType">
						<p ng-bind-html="message"></p>
					</div>
					<div class="table-responsive">
						<table class="table table-striped">
							<thead>
								<tr>
									<th width="1%">						
										<a type="button" class="btn btn-default btn-xs" disabled>
											<span class="glyphicon glyphicon-star-empty"></span>
										</a>
									</th>
									<!--<th width="10%"><a href="" ng-click="orderProp='lejania'">Lejan&iacute;a (mts)</a></th>-->
									<th width="12%">
										<div class="input-group">
											<span class="input-group-addon"><a href="" ng-click="orderProp='rutanombre'"><span class="glyphicon glyphicon-arrow-up"></span></a></span>
											<input ng-model="query.rutanombre" type="text" class="form-control input-sm" placeholder="Nombre" />
										</div>
									</th>
									<th width="20%">
										<span class="input-group-addon"><b>Origen - Destino</b></span>
									</th>
									<th width="25%">
										<div class="input-group">
											<span class="input-group-addon"><a href="" ng-click="orderProp='ascensoSugeridodescripcion'"><b>Subirse en</b></a></span>
											<input ng-model="query.ascensoSugeridodescripcion" type="text" class="form-control input-sm" placeholder="Ascenso sugerido" />
										</div>
									</th>
									<th width="25%">
										<div class="input-group">
											<span class="input-group-addon"><a href="" ng-click="orderProp='descensoSugeridodescripcion'"><b>Bajarse en</b></a></span>
											<input ng-model="query.descensoSugeridodescripcion" type="text" class="form-control input-sm" placeholder="Descenso sugerido" />
										</div>
									</th>			
									<th>-</th>
								</tr>
							</thead>

							<tbody>			
								<tr ng-repeat="sug in rutasuggest | filter:query | orderBy:orderProp">
									<td ng-show="sug.ruta.isFavorite == true">
										<a type="button"  class="btn btn-warning btn-xs" ng-click="favorito(sug.ruta)">
											<span class="glyphicon glyphicon-star"></span>
										</a>
									</td>
									<td ng-show="sug.ruta.isFavorite != true">
										<a type="button"  class="btn btn-default btn-xs" ng-click="favorito(sug.ruta)">
											<span class="glyphicon glyphicon-star-empty"></span>
										</a>
									</td>

									<!--<td>{{sug.lejania}}</td>-->
									<td>{{sug.rutanombre}}</td>
									<td>{{sug.ruta.origentxt}} - {{sug.ruta.destinotxt}}</td>
									<td>{{sug.ascensoSugerido.rutaPunto.descripcion}}</td>
									<td>{{sug.descensoSugerido.rutaPunto.descripcion}}</td>
									<td>
										<a type="button" class="btn btn-info" ng-click="showMapa(sug.ruta)"><span class="glyphicon glyphicon-map-marker"></span></a>						
										<a type="button" class="btn btn-info" ng-click="showCompraList(sug)"><span class="glyphicon glyphicon-usd"></span></a>		

										<!-- Modal - Corrida de las rutas -->
										<div class="modal fade modal-wide" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
											<div class="modal-dialog">
											    <div class="modal-content">

											      	<div class="modal-header">
												        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
												        <h4 class="modal-title" id="myModalLabel">{{sugSelected.ruta.nombre}}</h4>
												        <br/>
												        <b>Origen - Destino:</b> {{sugSelected.ruta.origentxt}} - {{sugSelected.ruta.destinotxt}}	
												        <br/>
												        <b>Subirse en:</b> {{sugSelected.ascensoSugerido.rutaPunto.descripcion}}	
												        <br/>
												        <b>Bajarse en:</b> {{sugSelected.descensoSugerido.rutaPunto.descripcion}}	
											    	</div>
											    	<div class="modal-header" ng-show="((errMsg != null)&&(errMsg != ''))||(sucMsg != null)&&(sucMsg != '')">
														<div class="alert alert-danger alert-dismissable" ng-show="(errMsg != null)&&(errMsg != '')">
														  <button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button>
														  <strong>Error!</strong> {{errMsg}}
														</div>
														<div class="alert alert-success alert-dismissable" ng-show="(sucMsg != null)&&(sucMsg != '')">
														  <button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button>
														  {{sucMsg}}
														</div>
													</div>
											    	<div class="modal-body">
														<div class="table-responsive">
															<table class="table table-hover">
																<thead>
																	<tr>
																		<th><a href="" ng-click="orderProp='id'">ID</a></th>
																		<th><a href="" ng-click="orderProp='horaSalidaFmt'">Hora de salida</a></th>
																		<th><a href="" ng-click="orderProp='horaLlegadaFmt'">Hora de llegada</a></th>
																		<th><a href="" ng-click="orderProp='oferta'">Lugares disponibles</a></th>
																		<th><a href="" ng-click="orderProp='tarifa'">Tarifa (MX$)</a></th>
																		<th>Folio</th>
																	</tr>
																</thead>

																<tbody>		
																	<tr ng-repeat-start="corrida in corridas | filter:query | orderBy:orderProp">
																		<tr class="info" ng-show="corrida.cambiaFecha">
																			<td colspan="6"><b>{{corrida.fecha}}
																			
																			</b></td>
																		</tr>
																		<td>{{corrida.id}}</td>
																		<td>{{corrida.rutaCorrida.horaSalidaFmt}}</td>
																		<td>{{corrida.rutaCorrida.horaLlegadaFmt}}</td>
																		<td>{{corrida.oferta}}</td>
																		<td>${{corrida.rutaCorrida.tarifa}}</td>
																		<td>
																			<!-- ESPERA con oferta -->
																			<p ng-show="(corrida.oferta > 0) && (corrida.espera == null)"></p>
																			<p ng-show="(corrida.oferta > 0) && (corrida.espera != null)">Lista de espera {{corrida.espera.folio}} </p>
																			<!-- ESPERA sin oferta -->
																			<p ng-show="(corrida.oferta <= 0) && (corrida.espera != null)">Lista de espera {{corrida.espera.folio}} </p>
																			<a ng-show="(corrida.oferta <= 0) && (corrida.espera == null) && (corrida.reservacion == null)" type="button" class="btn btn-warning" ng-click="esperar(corrida)">Lista de espera</a>

																			<!-- RESERVACION con oferta -->
																			<a ng-show="(corrida.oferta > 0) && (corrida.reservacion == null) && (corrida.espera == null)" type="button" class="btn btn-success" ng-click="reservar(corrida)">Reservar</a>
																			<b ng-show="(corrida.oferta > 0) && (corrida.reservacion != null)">Reservaci&oacute;n {{corrida.reservacion.folio}} </b>
																		
																			<!-- RESERVACION sin oferta -->
																			<b ng-show="(corrida.oferta <= 0) && (corrida.reservacion != null)">Reservaci&oacute;n {{corrida.reservacion.folio}} </b>
																			<b ng-show="(corrida.oferta <= 0) && (corrida.reservacion == null)"></b>

																	        <a type="button" class="btn btn-info btn-xs" data-toggle="collapse" data-target="#oferta{{corrida.id}}" class="accordion-toggle"><span class="glyphicon glyphicon-calendar"></span></a>


																		</td>
																	</tr>
																    <tr ng-repeat-end>	
																      <td class="hiddenRow" colspan="6" align="right">
																        <div class="accordion-body collapse" id="oferta{{corrida.id}}">

																			<div class="input-group">
																				<span class="input-group-addon">
																					<a ng-show="(corrida.rutaCorrida.capacidadReservada - corrida.rutaCorrida.reservacionesRecurrentes > 0)" type="button" class="btn btn-success" ng-click="reservarRecurrente(corrida)">Siempre ap&aacute;rtame lugar</a> Para los d&iacute;as: 																				
																				</span>
																				<span class="input-group-addon" ng-show="corrida.rutaCorrida.dia1==true">
																					<ul class="nav nav-pills">
																						<li class="active" ng-show="corrida.rutaCorrida.dia1==true"><a>Lun</a></li>
																						<li ng-show="corrida.rutaCorrida.dia1==false"><a>Lun</a></li>
																					</ul>
																				</span>
																				<span class="input-group-addon" ng-show="corrida.rutaCorrida.dia2==true">
																					<ul class="nav nav-pills">
																						<li class="active" ng-show="corrida.rutaCorrida.dia2==true"><a>Mar</a></li>
																						<li ng-show="corrida.rutaCorrida.dia2==false"><a>Mar</a></li>
																					</ul>
																				</span>
																				<span class="input-group-addon" ng-show="corrida.rutaCorrida.dia3==true">
																					<ul class="nav nav-pills">
																						<li class="active" ng-show="corrida.rutaCorrida.dia3==true"><a>Mi&eacute;</a></li>
																						<li ng-show="corrida.rutaCorrida.dia3==false"><a>Mi&eacute;</a></li>
																					</ul>
																				</span>
																				<span class="input-group-addon" ng-show="corrida.rutaCorrida.dia4==true">
																					<ul class="nav nav-pills">
																						<li class="active" ng-show="corrida.rutaCorrida.dia4==true"><a>Jue</a></li>
																						<li ng-show="corrida.rutaCorrida.dia4==false"><a>Jue</a></li>
																					</ul>
																				</span>
																				<span class="input-group-addon" ng-show="corrida.rutaCorrida.dia5==true">
																					<ul class="nav nav-pills">
																						<li class="active" ng-show="corrida.rutaCorrida.dia5==true"><a>Vie</a></li>
																						<li ng-show="corrida.rutaCorrida.dia5==false"><a>Vie</a></li>
																					</ul>
																				</span>
																				<span class="input-group-addon" ng-show="corrida.rutaCorrida.dia6==true">
																					<ul class="nav nav-pills">
																						<li class="active" ng-show="corrida.rutaCorrida.dia6==true"><a>Sab</a></li>
																						<li ng-show="corrida.rutaCorrida.dia6==false"><a>Sab</a></li>
																					</ul>
																				</span>
																				<span class="input-group-addon" ng-show="corrida.rutaCorrida.dia7==true">
																					<ul class="nav nav-pills">
																						<li class="active" ng-show="corrida.rutaCorrida.dia7==true"><a>Dom</a></li>
																						<li ng-show="corrida.rutaCorrida.dia7==false"><a>Dom</a></li>
																					</ul>
																				</span>
																			</div>	
																		</div>
																      </td>

																    </tr>		
																</tbody>
															</table>
														</div>				

											    	</div>

												    <div class="modal-footer">
												        <button type="button" class="btn btn-default" data-dismiss="modal">Cerrar</button>
												        <!--
												        <button type="button" class="btn btn-success">Salvar cambios</button>
												    -->
												    </div>
												
										    	</div>
										  	</div>
										</div>	<!-- End Modal -->

									</td>									
								</tr>
							</tbody>
						</table>		
						
					</div>
				</div>

				<div class="panel-heading" align="center">
					<button type="submit" class="btn btn-info" ng-disabled="exForm.$invalid" ng-click="sugerir()">Sugerir nuevas rutas</button>
				</div>

			</div> 
		</div>

   	    <div class="panel panel-primary">
			<div class="panel-heading" align="center">
				<!-- ayuda en seleccion de mapa -->

				<!-- sin sugerencias -->
				<div class="animate-switch" ng-if="mostrarSugerencias==false">
					<b>Ubicar el origen y destino de tu ruta.</b>
				</div>
				<!-- con sugerencias -->
				<div class="animate-switch" ng-if="mostrarSugerencias==true">
					<b>Refina tu origen y destino, posteriormente presiona "Sugerir nuevas rutas"</b> 
				</div>
						 
			</div>

			<div class="panel-body">
				<div class="table-responsive">
					<table class="table">
						<tbody>			
							<tr>
								<td>
									<div class="form-group" ng-class="{ 'has-error' : exForm.origentxt.$invalid && !exForm.origentxt.$pristine }">
										<img src="imgs/Origen.png" alt="Origen">
										<label for="origentxt">Origen</label>
										<input type="text" class="form-control" placeholder="Origen de la ruta" id="origentxt" name="origentxt" ng-model="ruta.origentxt" required/>
										<p ng-show="exForm.origentxt.$invalid && !exForm.origentxt.$pristine" class="help-block">Se requiere el origen de la ruta.</p>
									</div>
								</td>
								<td>
									<div class="form-group" ng-class="{ 'has-error' : exForm.destinotxt.$invalid && !exForm.destinotxt.$pristine }">
										<img src="imgs/Destino.png" alt="Destino">
										<label for="destinotxt">Destino</label>
										<input type="text" class="form-control" placeholder="Destino de la ruta" id="destinotxt" name="destinotxt" ng-model="ruta.destinotxt" required/>
										<p ng-show="exForm.destinotxt.$invalid && !exForm.destinotxt.$pristine" class="help-block">Se requiere el destino de la ruta.</p>
									</div>	
								</td>
								<!--
								<td style="vertical-align:middle" align="center">
									<button type="submit" class="btn btn-primary" ng-disabled="exForm.$invalid" ng-click="ubicar(ruta)">Ubicar en mapa</button>
								</td>
-->
							</tr>
							<tr>
								<td colspan="2">
									<div class="box efecto3" id="map_canvas" style="width: 90%; height: 100%"></div>
								</td>
							</tr>		
						</tbody>
					</table>		
					
				</div>			

			</div>  
			

	    </div>

	</div>  

<!--
      <div class="panel-body" align="center">
        <div id="consulta" ng-show="pMapa != null">
          <table class="table table-striped">
            <thead>
              <tr>
                <th>ID</th>
                <th>Descripci&oacuten</th>
                <th>Latitud</th>
                <th>Longitud</th>
                <th>Tipo</th>
              </tr>
            </thead>
          <tbody>
            <tr ng-repeat="emp in pMapa | filter:query | orderBy:orderProp ">
              <td>{{emp.id}}</td>
              <td>{{emp.descripcion}}</td>
              <td>{{emp.latitud}}</td>
              <td>{{emp.longitud}}</td>
              <td>{{emp.tipo}}</td>
            </tr>
          </tbody>
        </table>
        </div>
      </div>
    -->
        
</div>